"use strict";var shopping,adds,login=getCookie("login"),user=document.querySelector(".li1 a"),href=location.href,contentmain=document.querySelector(".shopping-main"),cont=document.querySelector(".content");function showdiv(){cont.innerHTML='\n    <div class="air">\n    <div class="ps">\n        <p>购物车帮您一次性完成批量购买与付款，下单更便捷，付款更简单！</p>\n    </div>\n    <p>您的位置：首页我的淘宝我的购物车</p>\n    <p>您的购物车还是空的，赶紧行动吧！您可以：</p>\n    <p class="kooe">看看：<i>我的收藏夹  </i></p>\n    <p class="kooe1">看看: <i>已买到的宝贝</i> </p>\n</div>\n    '}function showCart(){if(login)if(shopping=localStorage.getItem("shopping")){(shopping=JSON.parse(shopping)).length;var n=shopping.every(function(n){return 1==n.is_select}),i="";i='\n            <div class="shopping-top">\n            <ul>\n                <li class="li1">\n                    <a href="#" class="a1">全部商品 <i class=\'ili\'></i></a>\n                </li>\n                <li>\n                    <a href="#">降价商品 <i>0</i></a>\n                </li>\n                <li class="li3">\n                    <a href="#">库存紧张  <i>0</i></a>\n                </li>\n                <div class="sum">\n                    <span>已选商品(不含运费) <i class=\'reobs\'></i></span>\n                    <a href="#">结算</a>\n                </div>\n            </ul>\n            <div class="list-top">\n                <ul>\n                    <li class="i1"><input type="checkbox" class=\'all\''.concat(n?"checked":"",'> &nbsp;全选</li>\n                    <li class="i2">商品信息</li>\n\n                    <div class="ul-r">\n                        <ul>\n                            <li>单价</li>\n                            <li>数量</li>\n                            <li>金额</li>\n                            <li>操作</li>\n                        </ul>\n                    </div>\n                </ul>\n            </div>\n        </div>\n          \n            '),shopping.forEach(function(n){i+='\n                <div class="listbox">\n            <div class="list">\n                <div class="cart">\n                    <div class="cartlist">\n                        <ul>\n                            <li class="checkbox">\n                                <input type="checkbox" name=\'radio\''.concat(1===n.is_select?"checked":""," data-id=").concat(n.id,'>\n                            </li>\n                            <li class="imgli">\n                                <a href="#">\n                                    <img src="').concat(n.tp,'" alt="">\n                                </a>\n                            </li>\n                            <li class="title">\n                                <a href="#" title="').concat(n.bt,'">\n                                    ').concat(n.bt,'\n                                </a>\n                                <div class="promo">\n                                    <p> <img src="http://img.alicdn.com/tfs/TB1559E3oY1gK0jSZFCXXcwqXXa-25-16.png" alt=""></p>\n                                    <div class="logo">\n                                        <img src="http://assets.alicdn.com/sys/common/icon/trade/xcard.png" alt="">\n                                        <img src="http://img.alicdn.com/tps/i3/T1Vyl6FCBlXXaSQP_X-16-16.png" alt="">\n                                        <img src="http://img.alicdn.com/tps/i4/T1BCidFrNlXXaSQP_X-16-16.png" alt="">\n                                    </div>\n                                </div>\n                            </li>\n                            <li class="licolor">\n                                <p>颜色分类:黑色</p>\n                                <p>尺码:26/s[一尺9]</p>\n                            </li>\n    \n                            <li class="unit">\n                                <p class="origin">￥<i>').concat(n.origin,"</i></p>\n                                <p><i >").concat(n.price,'</i></p>\n                            </li>\n                            <li>\n                                <div class="number">\n                                    <a href="#" class=\'plus\' data-id=').concat(n.id,'>-</a>\n                                    <input type="text" value="').concat(n.number,'"').concat(n.number,">\n                                    <a href=\"#\" class='lose' da-id=").concat(n.id,'>+</a>\n                                </div>\n                            </li>\n                            <li class="money">\n                                <p><i>').concat(n.price,'</i></p>\n    \n                            </li>\n                            <li class="operat">\n                                <p>移入收藏夹</p>\n                                <p class="delete"data-id=').concat(n.id,'>删除</p>\n                                <p class="baby">相识宝贝</p>\n                            </li>\n                        </ul>\n                    </div>\n                </div>\n            </div>\n                </div>\n                \n               ')}),adds=tatoll(),i+='\n               \n            <div class="final">\n            <div class="final-left">\n                <div class="cat1">\n                    <input type="checkbox" class="all"'.concat(n?"checked":"",'> 全选\n                </div>\n                <div class="box">\n                    <a href="#" class="del">删除</a>\n                    <a href="#">移入删除夹</a>\n                    <a href="#">分享</a>\n                </div>\n            </div>\n            <div class="final-right">\n                <div class="sele">\n                    <a href="#">已选商品<i class="select">').concat(adds[0],'</i>件</a>\n                </div>\n                <div class="tet">\n                    <a href="#">合计(不含运费): <span class="plice">').concat(adds[1],'</span></a>\n                </div>\n                <button class="button">结算</button>\n            </div>\n        </div>\n            \n            '),contentmain.innerHTML=i,document.querySelector(".ili").innerHTML=shopping.length,document.querySelector(".reobs").innerHTML=adds[1]}else showdiv();else alert("您还未登录"),location.href="./login.html?Url="+href}function tatoll(){var i=0,s=0;return shopping.forEach(function(n){1==n.is_select&&(i+=parseInt(n.number),s+=parseInt(n.number)*parseFloat(n.origin))}),[i,s.toFixed(2)]}function abc(){document.querySelectorAll(".list").forEach(function(n){var i=$(n).find(".origin").children().html(),s=$(n).find(".number").children().eq(1).val(),a=parseFloat(i)*parseInt(s);$(n).find(".money").children().children().html("￥"+a.toFixed(2))})}login&&(user.innerHTML=login),showCart(),contentmain.onclick=function(n){var i=(n=n||window.event).target||n.srcElement;document.querySelectorAll(".checkbox input");if("all"===i.className&&(shopping.forEach(function(n){i.checked?n.is_select=1:n.is_select=0}),localStorage.setItem("shopping",JSON.stringify(shopping)),showCart(),abc()),"radio"===i.name){var s=i.getAttribute("data-id");shopping.forEach(function(n){n.id===s&&(1==n.is_select?n.is_select=0:n.is_select=1)}),localStorage.setItem("shopping",JSON.stringify(shopping)),showCart(),abc()}if("delete"===i.className){var a=i.getAttribute("data-id");shopping=shopping.filter(function(n){return n.id!=a}),localStorage.setItem("shopping",JSON.stringify(shopping)),showCart(),abc(),shopping.length<1&&showdiv()}if("del"===i.className&&(shopping=shopping.filter(function(n){return 1!=n.is_select}),localStorage.setItem("shopping",JSON.stringify(shopping)),showCart(),shopping.length<1&&showdiv(),abc()),"plus"===i.className){var t=i.getAttribute("data-id");shopping.forEach(function(n){n.id===t&&1<n.number&&n.number--}),localStorage.setItem("shopping",JSON.stringify(shopping)),showCart(),abc()}if("lose"===i.className){var l=i.getAttribute("da-id");shopping.forEach(function(n){n.id===l&&n.number++}),localStorage.setItem("shopping",JSON.stringify(shopping)),showCart(),abc()}"结算"===i.innerHTML&&(0<adds[0]?confirm("您确定要购买吗")&&(alert("您已成功支付"+adds[1]),shopping=shopping.filter(function(n){return 1!=n.is_select})):alert("您还未选中商品"),localStorage.setItem("shopping",JSON.stringify(shopping)),showCart(),shopping.length<1&&showdiv(),abc())},0===shopping.length&&showdiv(),abc();